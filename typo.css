@charset "utf-8";

/* =========================
   0) 设计变量 & 主题色
   ========================= */
:root{
  /* 颜色（保证对比度 AA 4.5+） */
  --c-bg: #ffffff;
  --c-fg: #1f2937;             /* slate-800 */
  --c-muted: #6b7280;          /* gray-500 */
  --c-border: #e5e7eb;         /* gray-200 */
  --c-link: #0f766e;           /* teal-700，较 #1abc9c 更稳重且对比更好 */
  --c-link-hover: #0b5e58;
  --c-code-bg: #f8fafc;        /* slate-50 */
  --c-code-border: #e2e8f0;    /* slate-200 */
  --c-blockquote-bar: #10b981; /* emerald-500 */

  /* 版面与节律 */
  --measure: 70ch;             /* 理想阅读宽度 */
  --radius: 8px;
  --leading: 1.75;             /* 正文行高 */
  --leading-tight: 1.35;       /* 标题行高 */
  --space-1: .25rem;
  --space-2: .5rem;
  --space-3: .75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;

  /* 字体 */
  --font-sans: "Noto Sans SC", "PingFang SC", "Microsoft Yahei", "Hiragino Sans GB", "WenQuanYi Micro Hei", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

  color-scheme: light dark;
}

/* 暗色主题变量 */
@media (prefers-color-scheme: dark){
  :root{
    --c-bg: #0b1220;           /* 深蓝灰背景 */
    --c-fg: #e5e7eb;
    --c-muted: #9ca3af;
    --c-border: #1f2937;
    --c-link: #22d3ee;         /* cyan-400 */
    --c-link-hover: #06b6d4;
    --c-code-bg: #0f172a;      /* slate-900 */
    --c-code-border: #1f2937;
    --c-blockquote-bar: #34d399;
  }
}

/* =========================
   1) 字体与基础排印
   ========================= */

/* 可变字体优先，自动回退；把极细字重换掉（中文常无 100/200） */
@supports (font-variation-settings: normal){
  html{
    font-family: var(--font-sans);
    font-weight: 400;
  }
}
html{
  color: var(--c-fg);
  background: var(--c-bg);
  -webkit-text-size-adjust: 100%;
  text-rendering: optimizeLegibility;
}

/* 盒模型（可选） */
html.borderbox *, html.borderbox *::before, html.borderbox *::after{
  box-sizing: border-box;
}

/* Reset */
body, dl, dt, dd, ul, ol, li, h1, h2, h3, h4, h5, h6, pre, code, form, fieldset, legend, input, textarea, p, blockquote, th, td, hr, button, article, aside, details, figcaption, figure, footer, header, menu, nav, section{
  margin: 0;
  padding: 0;
}

article, aside, details, figcaption, figure, footer, header, menu, nav, section{ display:block; }
audio, canvas, video{ display:inline-block; }
table{ border-collapse: collapse; border-spacing: 0; }
fieldset, img{ border: 0; }

/* 正文字体与行高 */
body, button, input, select, textarea{
  font: 400 1rem/var(--leading) var(--font-sans);
}

/* 阅读容器：限制行宽，提升节律 */
.typo{
  max-width: var(--measure);
  margin: 0 auto;
  padding: var(--space-6) var(--space-4);
}

/* =========================
   2) 链接与可访问性
   ========================= */

a{
  color: var(--c-link);
  text-decoration: underline;
  text-underline-offset: .15em;
  text-decoration-thickness: .08em;
  text-decoration-skip-ink: auto;
}
a:hover{ color: var(--c-link-hover); }

.typo a{
  /* 用真正的下划线取代 border-bottom，避免换行时的断裂与错位 */
  border-bottom: none;
}

:focus-visible{
  outline: 2px solid var(--c-link);
  outline-offset: 2px;
}

/* 高对比度用户 */
@media (prefers-contrast: more){
  a{ text-decoration-thickness: .12em; }
}

/* =========================
   3) 段落、标题与节奏
   ========================= */

.typo p, .typo pre, .typo ul, .typo ol, .typo dl, .typo form, .typo hr, .typo table, blockquote{
  margin-bottom: 1.2em;
}

/* 新属性：更好换行（Chrome/Edge/Firefox 已支持） */
.typo p{ text-wrap: pretty; }
.typo h1, .typo h2, .typo h3{ text-wrap: balance; }

h1, h2, h3, h4, h5, h6{
  font-family: var(--font-sans);
  color: var(--c-fg);
  line-height: var(--leading-tight);
  font-weight: 600; /* 避免中文超细字重导致的渲染不均 */
  margin-top: 1.2em;
  margin-bottom: .6em;
}
.typo h1{ font-size: 2rem; }
.typo h2{ font-size: 1.75rem; }
.typo h3{ font-size: 1.5rem; }
.typo h4{ font-size: 1.25rem; font-weight: 500; }
.typo h5, .typo h6{ font-size: 1.125rem; font-weight: 500; }

/* 让锚点标题不会被固定头遮住 */
.typo h1[id], .typo h2[id], .typo h3[id], .typo h4[id]{ scroll-margin-top: 80px; }

/* 引文：弱化文字色，强化竖线 */
blockquote{
  position: relative;
  color: var(--c-muted);
  border-left: 3px solid var(--c-blockquote-bar);
  padding-left: 1em;
  margin: 1em 0 1em 0;
}

/* =========================
   4) 中西文混排细节
   ========================= */

/* 避免拉丁词被粗暴折断，优先 pretty 换行 */
.textwrap, .textwrap td, .textwrap th{
  overflow-wrap: anywhere;   /* 现代首选 */
  word-break: normal;        /* 替代 break-all，减少英文单词断裂 */
}

/* CJK 行断行策略：loose 对中文友好；严格内容可用 strict */
:where(.typo){ line-break: loose; }

/* 数字/表格推荐等宽数字，对齐更整齐 */
:where(.typo, table){ font-variant-numeric: tabular-nums lining-nums; }

/* 中文强调点：使用标准属性替代自定义下划点阵列 */
.typo-em{
  -webkit-text-emphasis: filled dot;
  text-emphasis: filled dot;
  text-emphasis-position: under right; /* 中文常用在字下/右 */
}

/* 引号本地化（需配合 lang="zh-CN"） */
q{ quotes: "“" "”" "‘" "’"; }
q::before{ content: open-quote; }
q::after{ content: close-quote; }

/* 上下标的可读性 */
sub, sup{
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup{ top: -0.5em; }
sub{ bottom: -0.25em; }

/* =========================
   5) 列表与表格
   ========================= */

.typo ul{ margin-left: 1.3em; list-style: disc; }
.typo ol{ margin-left: 1.9em; list-style: decimal; }
.typo li ul{ margin-left: 2em; list-style: circle; }

.typo table{
  width: 100%;
  border: 1px solid var(--c-border);
  border-radius: var(--radius);
  overflow: hidden; /* 圆角生效 */
}
.typo table th, .typo table td, .typo table caption{
  border: 1px solid var(--c-border);
  padding: .6em .8em;
  color: #4b5563; /* slate-600 */
}
.typo table th{ background: #f8fafc; }
.typo table thead th{ background: #eef2ff; } /* indigo-50 */
.typo table caption{
  border-bottom: none;
  color: var(--c-muted);
  font-size: .95em;
}

/* 可选：粘顶表头（多列数据时很好用）
.typo table thead th{
  position: sticky; top: 0; z-index: 1;
} */

/* =========================
   6) 代码与内联码
   ========================= */

pre, code, pre tt{
  font-family: var(--font-mono);
  font-variant-ligatures: none;
}

pre{
  background: var(--c-code-bg);
  border: 1px solid var(--c-code-border);
  padding: 1em 1.25em;
  display: block;
  overflow: auto;
  tab-size: 4;
  border-radius: var(--radius);
}

code{
  background: var(--c-code-bg);
  border: 1px solid var(--c-code-border);
  padding: .15em .35em;
  border-radius: .35em;
}

/* 键盘标记 */
kbd{
  font-family: var(--font-mono);
  font-size: .9em;
  background: #11182711;
  border: 1px solid var(--c-border);
  border-bottom-width: 2px;
  border-radius: .4em;
  padding: .15em .4em;
}

/* =========================
   7) 其它细节
   ========================= */

hr{
  border: none;
  border-bottom: 1px solid var(--c-border);
  margin: 1.2em 0;
  height: 0;
}

small, figcaption{
  font-size: .9em;
  color: var(--c-muted);
}

strong, b{ font-weight: 700; color: #111; }

abbr[title]{ text-decoration: underline dotted; cursor: help; }

/* 图片响应式 */
.typo img{ max-width: 100%; height: auto; }

/* 清除浮动（如有需要） */
.clearfix::before, .clearfix::after{ content:""; display: table; }
.clearfix::after{ clear: both; }

/* =========================
   8) 打印版式（出版视角）
   ========================= */

@media print{
  body{ color: #000; background: #fff; }
  .typo{ max-width: none; padding: 0; }

  /* 避免孤行寡行 */
  p, blockquote, ul, ol, table, pre{ orphans: 3; widows: 3; }

  /* 避免代码/表格被拆页 */
  pre, table{ page-break-inside: avoid; }

  /* 链接显示 URL（可按需开启）
  a[href]::after{ content: " <" attr(href) ">"; font-size: .9em; color: #444; }
  */
}

/* =========================
   9) 与旧样式兼容的小修
   ========================= */

/* 保留你原来的 serif 辅助类 */
.serif{ font-family: Palatino, Optima, Georgia, serif; }

/* 重申按钮内边距修正（Firefox） */
button::-moz-focus-inner, input::-moz-focus-inner{ padding:0; border:0; }
